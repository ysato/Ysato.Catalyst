# 003_コードスタイルチェッカーの選択

## 概要

このパッケージでスキャフォールディングされるプロジェクトのコードスタイルチェッカーとしてPHP_CodeSnifferを採用し、Laravel公式のPintは採用しない。

## 課題

チーム開発における以下の課題を解決する必要があった：

- **チーム開発での一貫性確保**: 複数の開発者が参加するプロジェクトで、コーディングスタイルの統一が必要
- **コードレビューの効率化**: スタイルの議論に時間を割くのではなく、ロジックや設計に集中したい
- **保守性の向上**: 一貫したコーディングスタイルにより、コードの可読性を向上
- **PSR-12準拠**: PSR-12標準への準拠を確保

## 決定事項

スキャフォールディングで生成されるプロジェクトのコードスタイルチェッカーとしてPHP_CodeSnifferを採用し、PSR-12をベースとした設定で運用する。Laravel公式のPintは採用しない。

## ステータス

Accepted

## 詳細

### 前提

- PSR-12を基本的なコーディング標準として採用
- チーム開発での一貫性確保が最優先
- 拡張性とカスタマイズ性を重視
- PHP_CodeSnifferに関する既存の知識と経験がある

### 制約

- 学習コストは最小限に抑えたい
- 過度に複雑な設定は避けたい
- 他のツールとの連携を考慮する必要がある

### 検討した選択肢

#### 1. PHP_CodeSniffer（採用）
- **メリット**:
  - 既存の知識と経験により運用可能
  - 高い拡張性とカスタマイズ性
  - 豊富なルールセットと設定オプション
  - 成熟したツールとしての安定性
- **デメリット**:
  - 設定が複雑になる可能性
- **判定**: 経験と拡張性を重視し採用

#### 2. PHP-CS-Fixer
- **概要**: もう一つの主要なPHPコードスタイルチェッカー
- **問題点**: 過去にPHP_CodeSnifferと比較した際に劣っていた（具体的な理由は記録なし）
- **判定**: 過去の比較結果により不採用

#### 3. Pint
- **概要**: Laravel公式のコードフォーマッター（PHP-CS-Fixerのラッパー）
- **検討理由**: Laravelのエコシステムの一部として後から検討
- **問題点**:
  - PHP-CS-Fixerのラッパーであること
  - 設定は変更できるが全く新しいルールは作れない拡張性の制約
  - 参考: https://x.com/PHPCSFixer/status/1822965768398545305
- **判定**: 拡張性の制約により不採用

#### 4. StyleCI
- **概要**: クラウドベースのコードスタイルチェックサービス
- **問題点**: プライベートリポジトリが有料
- **判定**: コスト面で早期除外

### 運用方針

PHP_CodeSnifferをPSR-12ベースで運用し、以下の追加設定を含める：

- **PHPDocの順番ルール**: @varが最初、@throwsが最後など
- **Doctrine Coding Standard**: 一部のルールを採用
- **カスタムルール**: プロジェクト固有の要件に応じて追加

### 決定のタイミング

- **PHP_CodeSniffer採用**: プロジェクト開始時から決定していた
- **Pint検討と見送り**: プロジェクトの後期にLaravelエコシステムの観点から検討したが、拡張性の制約を知り候補から除外

### 今後の方針

PHP_CodeSnifferを継続使用し、必要に応じてカスタムルールを追加していく。Pintの拡張性が向上した場合は再検討の余地があるが、現時点では現行の選択を維持する。